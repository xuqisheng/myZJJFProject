!function(e){e.fn.fileupload=function(i){var l={name:"defaultname",accept:".jpg, .jpeg, .gif, .png",multiple:!1,complete:function(){}},n=e.extend(l,i),t=e(this),a='<div class="fileupload"><span class="J_file"></span><span class="fileselect-img J_selectFile"></span><input type="file" accept="'+n.accept+'" style="display: none;"></div>';t.html(a),t.on("click",".J_selectFile",function(){t.find("input:file").trigger("click")});var s=[];t.on("change","input:file",function(){if(window.FileReader){var i=this.files[0],l=new FileReader,a="";l.onload=function(i){if(a='<span class="imgbox J_imgbox"><img src="'+i.target.result+'"><span class="delete J_del"></span></span>',n.multiple){t.find(".J_file").append(a);var l=t.find(".J_file .J_imgbox img");s=[],e(l).each(function(){s.push(e(this).attr("src"))}),n.complete(s)}else t.find(".J_file").html(a),s.push(i.target.result),n.complete(s),t.find(".J_selectFile").hide()},l.readAsDataURL(i)}else alert("该功能暂不支持您当前使用的浏览器，请更换现代浏览器!")}),t.on("click",".J_del",function(){if(confirm("确定删除？")){e(this).parent(".J_imgbox").remove();var i=e(this).parent(".J_imgbox").find("img").attr("src");s.splice(e.inArray(i,s),1),n.complete(s),n.multiple||t.find(".J_selectFile").show()}})}}(jQuery);